<ng-container *ngIf="data.role == 'Client'">
  <h1 mat-dialog-title class="title">DEMANDE DE REPARATION</h1>
  <mat-dialog-content>
    <p> <mat-form-field appearance="fill" [style.width.%]="100">
        <mat-label>Voiture</mat-label>
        <mat-select required [formControl]="carsForm">
          <mat-option *ngFor="let car of carsList" [value]="car">
            <strong>{{car.brand}} {{car.model}}</strong> - {{car.registration}}
          </mat-option>
        </mat-select>
      </mat-form-field>
    </p>
    <p>
      <mat-form-field appearance="fill" [style.width.%]="100">
        <mat-label>Operation(s)</mat-label>
        <mat-select multiple="true" [formControl]="operationsForm">
          <mat-option *ngFor="let operation of operationsList" [value]="operation">
            {{operation.label}}
          </mat-option>
        </mat-select>
        <mat-hint *ngIf="operationsForm.value.length > 0 "> <span class="count"> Nombre d'operation :
            {{operationsForm.value.length}} </span></mat-hint>
      </mat-form-field>
    </p>
    <p>
      <mat-form-field appearance="fill" [style.width.%]="100">
        <mat-label>Note</mat-label>
        <textarea matInput [formControl]="noteForm"></textarea>
      </mat-form-field>
    </p>
  </mat-dialog-content>
  <mat-dialog-actions align="end">
    <button mat-flat-button color="warn" mat-dialog-close>Annuler</button>
    <button mat-flat-button color="primary" (click)="onSaveClick()" [disabled]="disableCheck()">Valider</button>
  </mat-dialog-actions>
</ng-container>

<ng-container *ngIf="data.role == 'Responsable atelier'">
  <h1 mat-dialog-title class="title">{{carInfo}}</h1>
  <mat-dialog-content>
    <!--content-with-operation-->
    <div *ngIf="repairRequest.operations != undefined">
      <form [formGroup]="formGroup">
        <div class="left">
          <p class="field-container">
            <mat-form-field appearance="fill" [style.width.%]="43">
              <mat-label>Date depot</mat-label>
              <input matInput formControlName="arrivedDateForm" readonly>
            </mat-form-field>
            <mat-form-field appearance="fill" class="field-margin" [style.width.%]="43">
              <mat-label>Durée reparation</mat-label>
              <input matInput formControlName="durationForm" required>
            </mat-form-field>
          </p>
          <p class="field-container">
            <mat-form-field appearance="fill" [style.width.%]="43">
              <mat-label>Debut reparation</mat-label>
              <input matInput [matDatepicker]="beginPicker" formControlName="repairBeginForm">
              <mat-hint>MM/JJ/AAAA</mat-hint>
              <mat-datepicker-toggle matIconSuffix [for]="beginPicker"></mat-datepicker-toggle>
              <mat-datepicker #beginPicker></mat-datepicker>
            </mat-form-field>
            <mat-form-field appearance="fill" class="field-margin" [style.width.%]="43">
              <mat-label>Fin reparation</mat-label>
              <input matInput [matDatepicker]="endPicker" formControlName="repairEndForm">
              <mat-hint>MM/JJ/AAAA</mat-hint>
              <mat-datepicker-toggle matIconSuffix [for]="endPicker"></mat-datepicker-toggle>
              <mat-datepicker #endPicker></mat-datepicker>
            </mat-form-field>
          </p>
          <p>
            <mat-form-field appearance="fill" [style.width.%]="100">
              <mat-label>Note</mat-label>
              <textarea matInput formControlName="noteForm"></textarea>
            </mat-form-field>
          </p>
        </div>
        <div class="right field-margin">
          <table class="customTable">
            <thead>
                <tr>
                    <th colspan="2">Liste d'operation</th>
                </tr>
            </thead>
            <tbody>
                <tr *ngFor="let operation of operationsList">
                    <td  colspan="2">- {{operation.label}}</td>
                </tr>
            </tbody>
            <tfoot>
              <tr>
                  <th>Montant</th>
                  <td>{{repairRequest.cost}} Ar</td>
              </tr>
          </tfoot>
        </table>

        </div>
      </form>
    </div>
    <!--content-with-operation-->
    <div *ngIf="repairRequest.operations == undefined">
      <form [formGroup]="formGroup">
        <p class="field-container">
          <mat-form-field appearance="fill" [style.width.%]="43">
            <mat-label>Operation(s)</mat-label>
            <mat-select multiple="true" formControlName="operationForm" (selectionChange)="onSelectionChange()">
              <mat-option *ngFor="let operation of operationsList" [value]="operation"  >
                {{operation.label}}
              </mat-option>
            </mat-select>
            <mat-hint *ngIf="selectedOperationLength > 0 "> <span class="count"> Nombre d'operation :
              {{selectedOperationLength}} </span></mat-hint>
          </mat-form-field>
          <mat-form-field appearance="fill" class="field-margin" [style.width.%]="43">
            <mat-label>Montant total</mat-label>
            <input matInput formControlName="costForm" readonly>
          </mat-form-field>
        </p>
        <p class="field-container">
          <mat-form-field appearance="fill" [style.width.%]="43">
            <mat-label>Date depot</mat-label>
            <input matInput formControlName="arrivedDateForm" readonly>
          </mat-form-field>
          <mat-form-field appearance="fill" class="field-margin" [style.width.%]="43">
            <mat-label>Durée reparation</mat-label>
            <input matInput formControlName="durationForm" required>
          </mat-form-field>
        </p>
        <p class="field-container">
          <mat-form-field appearance="fill" [style.width.%]="43">
            <mat-label>Debut reparation</mat-label>
            <input matInput [matDatepicker]="beginPicker" formControlName="repairBeginForm">
            <mat-hint>MM/JJ/AAAA</mat-hint>
            <mat-datepicker-toggle matIconSuffix [for]="beginPicker"></mat-datepicker-toggle>
            <mat-datepicker #beginPicker></mat-datepicker>
          </mat-form-field>
          <mat-form-field appearance="fill" class="field-margin" [style.width.%]="43">
            <mat-label>Fin reparation</mat-label>
            <input matInput [matDatepicker]="endPicker" formControlName="repairEndForm">
            <mat-hint>MM/JJ/AAAA</mat-hint>
            <mat-datepicker-toggle matIconSuffix [for]="endPicker"></mat-datepicker-toggle>
            <mat-datepicker #endPicker></mat-datepicker>
          </mat-form-field>
        </p>
        <p>
          <mat-form-field appearance="fill" [style.width.%]="100">
            <mat-label>Note</mat-label>
            <textarea matInput formControlName="noteForm"></textarea>
          </mat-form-field>
        </p>
      </form>
    </div>
  </mat-dialog-content>
  <mat-dialog-actions align="end">
    <button mat-flat-button color="warn" mat-dialog-close>Annuler</button>
    <button mat-flat-button color="primary" (click)="onConfirmClick()">Valider</button>
  </mat-dialog-actions>
</ng-container>

<ng-container *ngIf="data.role == 'Responsable financier'">
  <h1 mat-dialog-title class="title">PAIEMENT</h1>
  <mat-dialog-content>
    <p>
      <mat-form-field appearance="fill" [style.width.%]="100">
        <mat-label>Reparation</mat-label>
        <mat-select [formControl]="repairPaymentForm" (selectionChange)="onRepairSelectionChange()">
          <mat-option *ngFor="let repair of repairsList" [value]="repair">
            {{repair._id}}
          </mat-option>
        </mat-select>
      </mat-form-field>
    </p>
    <div class="field-container">
      <mat-form-field appearance="fill" [style.width.%]="34">
        <mat-label>Montant</mat-label>
        <input matInput [formControl]="amountForm" readonly>
      </mat-form-field>
      <mat-form-field appearance="fill" class="field-margin" [style.width.%]="34">
        <mat-label>Payé</mat-label>
        <input matInput [formControl]="paidAmountForm">
      </mat-form-field>
    </div>
  </mat-dialog-content>
  <mat-dialog-actions align="end">
    <button mat-flat-button color="warn" mat-dialog-close>Annuler</button>
    <button mat-flat-button color="primary" (click)="onConfirmPaymentClick()">Valider</button>
  </mat-dialog-actions>
</ng-container>


